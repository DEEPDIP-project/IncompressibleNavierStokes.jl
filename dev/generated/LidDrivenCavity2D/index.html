<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Lid-Driven Cavity · IncompressibleNavierStokes.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://agdestein.github.io/IncompressibleNavierStokes.jl/generated/LidDrivenCavity2D/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="IncompressibleNavierStokes.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">IncompressibleNavierStokes.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Lid-Driven Cavity</a><ul class="internal"><li><a class="tocitem" href="#Build-problem"><span>Build problem</span></a></li><li><a class="tocitem" href="#Solve-problems"><span>Solve problems</span></a></li><li><a class="tocitem" href="#Postprocess"><span>Postprocess</span></a></li></ul></li></ul></li><li><span class="tocitem">Theory</span><ul><li><a class="tocitem" href="../../theory/theory/">Theory</a></li><li><a class="tocitem" href="../../theory/operators/">Operators</a></li><li><a class="tocitem" href="../../theory/rom/">Reduced Order Models</a></li><li><a class="tocitem" href="../../theory/ibm/">Immersed Boundary Method</a></li></ul></li><li><a class="tocitem" href="../../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Lid-Driven Cavity</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Lid-Driven Cavity</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/master/examples/LidDrivenCavity2D.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Lid-Driven-Cavity-case-(LDC)"><a class="docs-heading-anchor" href="#Lid-Driven-Cavity-case-(LDC)">Lid-Driven Cavity case (LDC)</a><a id="Lid-Driven-Cavity-case-(LDC)-1"></a><a class="docs-heading-anchor-permalink" href="#Lid-Driven-Cavity-case-(LDC)" title="Permalink"></a></h1><p>This test case considers a box with a moving lid, where the velocity is initially at rest.</p><p>We start by loading IncompressibleNavierStokes and a Makie plotting backend.</p><pre><code class="language- hljs">using IncompressibleNavierStokes

if haskey(ENV, &quot;GITHUB_ACTIONS&quot;)
    using CairoMakie
else
    using GLMakie
end</code></pre><h2 id="Build-problem"><a class="docs-heading-anchor" href="#Build-problem">Build problem</a><a id="Build-problem-1"></a><a class="docs-heading-anchor-permalink" href="#Build-problem" title="Permalink"></a></h2><p>We may choose the floating point type for the simulations. Replacing <code>Float64</code> with <code>Float32</code> will not necessarilily speed up the simulations, but requires half as much memory.</p><pre><code class="language-julia hljs">T = Float64</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Float64</code></pre><p>Available viscosity models are:</p><ul><li><a href="../../api/#IncompressibleNavierStokes.LaminarModel"><code>LaminarModel</code></a>,</li><li><a href="../../api/#IncompressibleNavierStokes.KEpsilonModel"><code>KEpsilonModel</code></a>,</li><li><a href="../../api/#IncompressibleNavierStokes.MixingLengthModel"><code>MixingLengthModel</code></a>,</li><li><a href="../../api/#IncompressibleNavierStokes.SmagorinskyModel"><code>SmagorinskyModel</code></a>, and</li><li><a href="../../api/#IncompressibleNavierStokes.QRModel"><code>QRModel</code></a>.</li></ul><p>They all take a Reynolds number as a parameter. Here we choose a moderate Reynolds number.</p><pre><code class="language-julia hljs">viscosity_model = LaminarModel{T}(; Re = 1000)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">LaminarModel{Float64}(1000.0)</code></pre><p>Available convection models are:</p><ul><li><a href="../../api/#IncompressibleNavierStokes.NoRegConvectionModel"><code>NoRegConvectionModel</code></a>,</li><li><a href="../../api/#IncompressibleNavierStokes.C2ConvectionModel"><code>C2ConvectionModel</code></a>,</li><li><a href="../../api/#IncompressibleNavierStokes.C4ConvectionModel"><code>C4ConvectionModel</code></a>, and</li><li><a href="../../api/#IncompressibleNavierStokes.LerayConvectionModel"><code>LerayConvectionModel</code></a>.</li></ul><p>We here take the simplest model.</p><pre><code class="language-julia hljs">convection_model = NoRegConvectionModel{T}()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">NoRegConvectionModel{Float64}()</code></pre><p>We create a two-dimensional domain with a box of size <code>[1, 1]</code>.</p><pre><code class="language-julia hljs">Nx = 100                          # Number of x-volumes
Ny = 100                          # Number of y-volumes
grid = create_grid(
    T,
    Nx,
    Ny;
    xlims = (0, 1),               # Horizontal limits (left, right)
    ylims = (0, 1),               # Vertical limits (bottom, top)
    stretch = (1, 1),             # Stretch factor (sx, sy)
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Grid{Float64, 2}(100, 100, 1, (0.0, 1.0), (0.0, 1.0), (0.0, 1.0), [0.0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09  …  0.91, 0.92, 0.93, 0.94, 0.95, 0.96, 0.97, 0.98, 0.99, 1.0], [0.0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09  …  0.91, 0.92, 0.93, 0.94, 0.95, 0.96, 0.97, 0.98, 0.99, 1.0], Float64[], [0.005, 0.015000000000000001, 0.025, 0.035, 0.045, 0.055, 0.065, 0.075, 0.085, 0.095  …  0.905, 0.915, 0.9249999999999999, 0.9349999999999999, 0.9450000000000001, 0.955, 0.965, 0.9749999999999999, 0.9850000000000001, 0.995], [0.005, 0.015000000000000001, 0.025, 0.035, 0.045, 0.055, 0.065, 0.075, 0.085, 0.095  …  0.905, 0.915, 0.9249999999999999, 0.9349999999999999, 0.9450000000000001, 0.955, 0.965, 0.9749999999999999, 0.9850000000000001, 0.995], Float64[], 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], [0.01, 0.01, 0.009999999999999998, 0.010000000000000002, 0.010000000000000002, 0.009999999999999995, 0.010000000000000009, 0.009999999999999995, 0.009999999999999995, 0.010000000000000009  …  0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.009999999999999898, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009], [0.01, 0.01, 0.009999999999999998, 0.010000000000000002, 0.010000000000000002, 0.009999999999999995, 0.010000000000000009, 0.009999999999999995, 0.009999999999999995, 0.010000000000000009  …  0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.009999999999999898, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], [0.005, 0.01, 0.009999999999999998, 0.01, 0.010000000000000002, 0.009999999999999998, 0.010000000000000002, 0.010000000000000002, 0.009999999999999995, 0.010000000000000002  …  0.010000000000000009, 0.010000000000000009, 0.009999999999999953, 0.009999999999999953, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.0050000000000000044], [0.005, 0.01, 0.009999999999999998, 0.01, 0.010000000000000002, 0.009999999999999998, 0.010000000000000002, 0.010000000000000002, 0.009999999999999995, 0.010000000000000002  …  0.010000000000000009, 0.010000000000000009, 0.009999999999999953, 0.009999999999999953, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.0050000000000000044], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), Float64[], Float64[], Float64[], Matrix{Float64}(undef, 0, 0), Matrix{Float64}(undef, 0, 0), Matrix{Float64}(undef, 0, 0), Matrix{Float64}(undef, 0, 0), Matrix{Float64}(undef, 0, 0), Matrix{Float64}(undef, 0, 0), Matrix{Float64}(undef, 0, 0), Matrix{Float64}(undef, 0, 0), Matrix{Float64}(undef, 0, 0), Matrix{Float64}(undef, 0, 0), Matrix{Float64}(undef, 0, 0), Matrix{Float64}(undef, 0, 0), 0:0, 0:0, 0:0, 0:0, 0:0)</code></pre><p>Solver settings are used by certain implicit solvers.</p><pre><code class="language-julia hljs">solver_settings = SolverSettings{T}(;
    pressure_solver = DirectPressureSolver{T}(),    # Pressure solver
    p_add_solve = true,                             # Additional pressure solve for second order pressure
    abstol = 1e-10,                                 # Absolute accuracy
    reltol = 1e-14,                                 # Relative accuracy
    maxiter = 10,                                   # Maximum number of iterations
    newton_type = :approximate,
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SolverSettings{Float64}(DirectPressureSolver{Float64}(SuiteSparse.CHOLMOD.Factor{Float64}
type:    LLt
method:  simplicial
maxnnz:  1
nnz:     0
success: true
), true, 1.0e-10, 1.0e-14, 10, :approximate, false)</code></pre><p>Dirichlet boundary conditions are specified as plain Julia functions. They are marked by the <code>:dirichlet</code> symbol. Other possible BC types are <code>:periodic</code>, <code>:symmetric</code>, and <code>:pressure</code>.</p><pre><code class="language-julia hljs">u_bc(x, y, t, setup) = y ≈ setup.grid.ylims[2] ? 1.0 : 0.0
v_bc(x, y, t, setup) = zero(x)
bc = create_boundary_conditions(
    T,
    u_bc,
    v_bc;
    bc_unsteady = false,
    bc_type = (;
        u = (; x = (:dirichlet, :dirichlet), y = (:dirichlet, :dirichlet)),
        v = (; x = (:dirichlet, :dirichlet), y = (:dirichlet, :dirichlet)),
        k = (; x = (:dirichlet, :dirichlet), y = (:dirichlet, :dirichlet)),
        e = (; x = (:dirichlet, :dirichlet), y = (:dirichlet, :dirichlet)),
        ν = (; x = (:dirichlet, :dirichlet), y = (:dirichlet, :dirichlet)),
    ),
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BC{Float64}(false, (x = (:dirichlet, :dirichlet), y = (:dirichlet, :dirichlet)), (x = (:dirichlet, :dirichlet), y = (:dirichlet, :dirichlet)), NamedTuple(), (x = (:dirichlet, :dirichlet), y = (:dirichlet, :dirichlet)), (x = (:dirichlet, :dirichlet), y = (:dirichlet, :dirichlet)), (x = (:dirichlet, :dirichlet), y = (:dirichlet, :dirichlet)), Main.u_bc, Main.v_bc, IncompressibleNavierStokes.var&quot;#92#120&quot;(), IncompressibleNavierStokes.var&quot;#93#121&quot;(), IncompressibleNavierStokes.var&quot;#94#122&quot;(), IncompressibleNavierStokes.var&quot;#95#123&quot;(), (x = (0, 0), y = (0, 0)), (x = (0, 0), y = (0, 0)), (x = (0, 0), y = (0, 0)), IncompressibleNavierStokes.var&quot;#96#124&quot;())</code></pre><p>The body forces are specified as plain Julia functions.</p><pre><code class="language-julia hljs">bodyforce_u(x, y) = 0
bodyforce_v(x, y) = 0
force = SteadyBodyForce{T}(; bodyforce_u, bodyforce_v)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SteadyBodyForce{Float64}(Main.bodyforce_u, Main.bodyforce_v, IncompressibleNavierStokes.var&quot;#18#30&quot;(), Float64[])</code></pre><p>We may now assemble our setup.</p><pre><code class="language-julia hljs">setup = Setup{T,2}(; viscosity_model, convection_model, grid, force, solver_settings, bc)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Setup{Float64, 2}(LaminarModel{Float64}(1000.0), NoRegConvectionModel{Float64}(), Grid{Float64, 2}(100, 100, 1, (0.0, 1.0), (0.0, 1.0), (0.0, 1.0), [0.0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09  …  0.91, 0.92, 0.93, 0.94, 0.95, 0.96, 0.97, 0.98, 0.99, 1.0], [0.0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09  …  0.91, 0.92, 0.93, 0.94, 0.95, 0.96, 0.97, 0.98, 0.99, 1.0], Float64[], [0.005, 0.015000000000000001, 0.025, 0.035, 0.045, 0.055, 0.065, 0.075, 0.085, 0.095  …  0.905, 0.915, 0.9249999999999999, 0.9349999999999999, 0.9450000000000001, 0.955, 0.965, 0.9749999999999999, 0.9850000000000001, 0.995], [0.005, 0.015000000000000001, 0.025, 0.035, 0.045, 0.055, 0.065, 0.075, 0.085, 0.095  …  0.905, 0.915, 0.9249999999999999, 0.9349999999999999, 0.9450000000000001, 0.955, 0.965, 0.9749999999999999, 0.9850000000000001, 0.995], Float64[], 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], [0.01, 0.01, 0.009999999999999998, 0.010000000000000002, 0.010000000000000002, 0.009999999999999995, 0.010000000000000009, 0.009999999999999995, 0.009999999999999995, 0.010000000000000009  …  0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.009999999999999898, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009], [0.01, 0.01, 0.009999999999999998, 0.010000000000000002, 0.010000000000000002, 0.009999999999999995, 0.010000000000000009, 0.009999999999999995, 0.009999999999999995, 0.010000000000000009  …  0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.009999999999999898, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], [0.005, 0.01, 0.009999999999999998, 0.01, 0.010000000000000002, 0.009999999999999998, 0.010000000000000002, 0.010000000000000002, 0.009999999999999995, 0.010000000000000002  …  0.010000000000000009, 0.010000000000000009, 0.009999999999999953, 0.009999999999999953, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.0050000000000000044], [0.005, 0.01, 0.009999999999999998, 0.01, 0.010000000000000002, 0.009999999999999998, 0.010000000000000002, 0.010000000000000002, 0.009999999999999995, 0.010000000000000002  …  0.010000000000000009, 0.010000000000000009, 0.009999999999999953, 0.009999999999999953, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.010000000000000009, 0.0050000000000000044], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), Float64[], Float64[], Float64[], Matrix{Float64}(undef, 0, 0), Matrix{Float64}(undef, 0, 0), Matrix{Float64}(undef, 0, 0), Matrix{Float64}(undef, 0, 0), Matrix{Float64}(undef, 0, 0), Matrix{Float64}(undef, 0, 0), Matrix{Float64}(undef, 0, 0), Matrix{Float64}(undef, 0, 0), Matrix{Float64}(undef, 0, 0), Matrix{Float64}(undef, 0, 0), Matrix{Float64}(undef, 0, 0), Matrix{Float64}(undef, 0, 0), 0:0, 0:0, 0:0, 0:0, 0:0), Operators{Float64}(false, 81.0, 1.125, sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), sparse(Int64[], Int64[], Float64[], 0, 0), NamedTuple(), NamedTuple(), NamedTuple(), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), sparse(Int64[], Int64[], Float64[], 0, 0), Float64[], Float64[], Float64[], Float64[], sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), sparse(Int64[], Int64[], Float64[], 0, 0), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), NamedTuple(), Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[], Float64[]), SteadyBodyForce{Float64}(Main.bodyforce_u, Main.bodyforce_v, IncompressibleNavierStokes.var&quot;#18#30&quot;(), Float64[]), SolverSettings{Float64}(DirectPressureSolver{Float64}(SuiteSparse.CHOLMOD.Factor{Float64}
type:    LLt
method:  simplicial
maxnnz:  1
nnz:     0
success: true
), true, 1.0e-10, 1.0e-14, 10, :approximate, false), BC{Float64}(false, (x = (:dirichlet, :dirichlet), y = (:dirichlet, :dirichlet)), (x = (:dirichlet, :dirichlet), y = (:dirichlet, :dirichlet)), NamedTuple(), (x = (:dirichlet, :dirichlet), y = (:dirichlet, :dirichlet)), (x = (:dirichlet, :dirichlet), y = (:dirichlet, :dirichlet)), (x = (:dirichlet, :dirichlet), y = (:dirichlet, :dirichlet)), Main.u_bc, Main.v_bc, IncompressibleNavierStokes.var&quot;#92#120&quot;(), IncompressibleNavierStokes.var&quot;#93#121&quot;(), IncompressibleNavierStokes.var&quot;#94#122&quot;(), IncompressibleNavierStokes.var&quot;#95#123&quot;(), (x = (0, 0), y = (0, 0)), (x = (0, 0), y = (0, 0)), (x = (0, 0), y = (0, 0)), IncompressibleNavierStokes.var&quot;#96#124&quot;()))</code></pre><p>The discrete operators are built with the <a href="../../api/#IncompressibleNavierStokes.build_operators!"><code>build_operators!</code></a> function.</p><pre><code class="language-julia hljs">build_operators!(setup);</code></pre><p>We will solve for a time interval of ten seconds.</p><pre><code class="language-julia hljs">t_start, t_end = tlims = (0.0, 10.0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(0.0, 10.0)</code></pre><p>The initial conditions are defined as plain Julia functions.</p><pre><code class="language-julia hljs">initial_velocity_u(x, y) = 0
initial_velocity_v(x, y) = 0
initial_pressure(x, y) = 0
V₀, p₀ = create_initial_conditions(
    setup,
    t_start;
    initial_velocity_u,
    initial_velocity_v,
    initial_pressure,
);</code></pre><p>We may also define a list of iteration processors. They are processed after every <code>nupdate</code> iteration.</p><pre><code class="language-julia hljs">logger = Logger(; nupdate = 10)
real_time_plotter = RealTimePlotter(; nupdate = 5, fieldname = :vorticity)
tracer = QuantityTracer(; nupdate = 1)
processors = [logger, real_time_plotter, tracer]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3-element Vector{IncompressibleNavierStokes.Processor}:
 Logger(10)
 RealTimePlotter(5, :vorticity, Observable{Nothing} with 0 listeners. Value:
nothing)
 QuantityTracer(1, Float64[], Float64[], Float64[], Float64[], Float64[], Float64[])</code></pre><h2 id="Solve-problems"><a class="docs-heading-anchor" href="#Solve-problems">Solve problems</a><a id="Solve-problems-1"></a><a class="docs-heading-anchor-permalink" href="#Solve-problems" title="Permalink"></a></h2><p>There are many different problems. They can all be solved by calling the <a href="../../api/#IncompressibleNavierStokes.solve"><code>solve</code></a> function.</p><p>A <a href="../../api/#IncompressibleNavierStokes.SteadyStateProblem"><code>SteadyStateProblem</code></a> is for computing a state where the right hand side of the momentum equation is zero.</p><pre><code class="language-julia hljs">problem = SteadyStateProblem(setup, V₀, p₀);
V, p = @time solve(problem; processors);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Initial momentum residual = 0.001959700502304355
Iteration 1: momentum residual = 0.001231395188483114
Iteration 2: momentum residual = 0.00036971660713867307
Iteration 3: momentum residual = 5.9744826258877374e-5
Iteration 4: momentum residual = 1.932529935631683e-5
Iteration 5: momentum residual = 3.3496153503953925e-6
Iteration 6: momentum residual = 5.089010398338933e-7
Iteration 7: momentum residual = 4.362434397823644e-10
Iteration 8: momentum residual = 8.54852755423352e-16
  5.256943 seconds (5.71 M allocations: 1.292 GiB, 11.50% gc time, 50.02% compilation time)</code></pre><p>For this test case, the same steady state may be obtained by solving an <a href="../../api/#IncompressibleNavierStokes.UnsteadyProblem"><code>UnsteadyProblem</code></a> for a sufficiently long time. A ODE method is needed in this case. Here we will opt for a standard fourth order Runge-Kutta method with a fixed time step.</p><pre><code class="language- hljs">problem = UnsteadyProblem(setup, V₀, p₀, tlims);
V, p = @time solve(problem, RK44(); Δt = 0.01, processors);
nothing #hide</code></pre><h2 id="Postprocess"><a class="docs-heading-anchor" href="#Postprocess">Postprocess</a><a id="Postprocess-1"></a><a class="docs-heading-anchor-permalink" href="#Postprocess" title="Permalink"></a></h2><p>The <code>tracer</code> object contains a history of some quantities related to the momentum and energy.</p><pre><code class="language-julia hljs">plot_tracers(tracer)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Figure()</code></pre><p>We may also plot the final pressure field,</p><pre><code class="language-julia hljs">plot_pressure(setup, p)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Figure()</code></pre><p>vorticity field,</p><pre><code class="language-julia hljs">plot_vorticity(setup, V, tlims[2])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Figure()</code></pre><p>or streamfunction.</p><pre><code class="language-julia hljs">plot_streamfunction(setup, V, tlims[2])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Figure()</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../getting_started/">« Getting Started</a><a class="docs-footer-nextpage" href="../../theory/theory/">Theory »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Tuesday 11 January 2022 23:32">Tuesday 11 January 2022</span>. Using Julia version 1.7.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
