<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · IncompressibleNavierStokes.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://agdestein.github.io/IncompressibleNavierStokes.jl/api/api/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="IncompressibleNavierStokes.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">IncompressibleNavierStokes.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../generated/Actuator2D/">Actuator (2D)</a></li><li><a class="tocitem" href="../../generated/BackwardFacingStep2D/">Backward Facing Step (2D)</a></li><li><a class="tocitem" href="../../generated/DecayingTurbulence2D/">Decaying Turbulunce (2D)</a></li><li><a class="tocitem" href="../../generated/LidDrivenCavity2D/">Lid-Driven Cavity (2D)</a></li><li><a class="tocitem" href="../../generated/PlanarMixing2D/">Planar Mixing (2D)</a></li><li><a class="tocitem" href="../../generated/ShearLayer2D/">Shear Layer (2D)</a></li><li><a class="tocitem" href="../../generated/TaylorGreenVortex3D/">Taylor-Green Vortex (3D)</a></li></ul></li><li><span class="tocitem">Theory</span><ul><li><a class="tocitem" href="../../theory/theory/">Theory</a></li><li><a class="tocitem" href="../../theory/operators/">Operators</a></li><li><a class="tocitem" href="../../theory/rom/">Reduced Order Models</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Boundary-conditions"><span>Boundary conditions</span></a></li><li><a class="tocitem" href="#Force"><span>Force</span></a></li><li><a class="tocitem" href="#Grid"><span>Grid</span></a></li><li><a class="tocitem" href="#Visocosity-Models"><span>Visocosity Models</span></a></li><li><a class="tocitem" href="#Convection-Models"><span>Convection Models</span></a></li><li><a class="tocitem" href="#Momentum"><span>Momentum</span></a></li><li><a class="tocitem" href="#Operators"><span>Operators</span></a></li><li><a class="tocitem" href="#Postprocess"><span>Postprocess</span></a></li><li><a class="tocitem" href="#Preprocess"><span>Preprocess</span></a></li><li><a class="tocitem" href="#Problems"><span>Problems</span></a></li><li><a class="tocitem" href="#Processors"><span>Processors</span></a></li><li><a class="tocitem" href="#Solvers"><span>Solvers</span></a></li><li><a class="tocitem" href="#Time-steppers"><span>Time steppers</span></a></li><li><a class="tocitem" href="#Utils"><span>Utils</span></a></li></ul></li><li><a class="tocitem" href="../tableaux/">Runge-Kutta methods</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Reference</a></li><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/main/docs/src/api/api.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.IncompressibleNavierStokes" href="#IncompressibleNavierStokes.IncompressibleNavierStokes"><code>IncompressibleNavierStokes.IncompressibleNavierStokes</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">IncompressibleNavierStokes</code></pre><p>Energy-conserving solvers for the incompressible Navier-Stokes equations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/IncompressibleNavierStokes.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.Setup" href="#IncompressibleNavierStokes.Setup"><code>IncompressibleNavierStokes.Setup</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Setup(grid, boundary_conditions, viscosity_model, convection_model, force, operators)</code></pre><p>Simulation setup.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/setup.jl#L1-L5">source</a></section></article><h2 id="Boundary-conditions"><a class="docs-heading-anchor" href="#Boundary-conditions">Boundary conditions</a><a id="Boundary-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Boundary-conditions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.BoundaryConditions" href="#IncompressibleNavierStokes.BoundaryConditions"><code>IncompressibleNavierStokes.BoundaryConditions</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">BoundaryConditions{T}</code></pre><p>Boundary conditions with floating point type <code>T</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/boundary_conditions/boundary_conditions.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.get_bc_vectors" href="#IncompressibleNavierStokes.get_bc_vectors"><code>IncompressibleNavierStokes.get_bc_vectors</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_bc_vectors(setup, t)</code></pre><p>Get boundary condition vectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/boundary_conditions/get_bc_vectors.jl#L1-L5">source</a></section></article><h2 id="Force"><a class="docs-heading-anchor" href="#Force">Force</a><a id="Force-1"></a><a class="docs-heading-anchor-permalink" href="#Force" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.SteadyBodyForce" href="#IncompressibleNavierStokes.SteadyBodyForce"><code>IncompressibleNavierStokes.SteadyBodyForce</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SteadyBodyForce{F1,F2,F3,T}</code></pre><p>Steady (constant) body force.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/force/force.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.UnsteadyBodyForce" href="#IncompressibleNavierStokes.UnsteadyBodyForce"><code>IncompressibleNavierStokes.UnsteadyBodyForce</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">UnsteadyBodyForce{F1,F2,F3,T}</code></pre><p>Unsteady (time-dependent) body force.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/force/force.jl#L42-L46">source</a></section></article><h2 id="Grid"><a class="docs-heading-anchor" href="#Grid">Grid</a><a id="Grid-1"></a><a class="docs-heading-anchor-permalink" href="#Grid" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.Grid" href="#IncompressibleNavierStokes.Grid"><code>IncompressibleNavierStokes.Grid</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Grid{T,N}()</code></pre><p>Nonuniform Cartesian grid of dimension <code>N</code> and floating point type <code>T</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/grid/grid.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.cosine_grid" href="#IncompressibleNavierStokes.cosine_grid"><code>IncompressibleNavierStokes.cosine_grid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">cosine_grid(a, b, N)</code></pre><p>Create a nonuniform grid of <code>N + 1</code> points from <code>a</code> to <code>b</code> using a cosine profile, i.e.</p><p class="math-container">\[x_i = a + \frac{1}{2} \left( 1 - \cos \left( \pi \frac{i}{n} \right) \right)
(b - a), \quad i = 0, \dots, N\]</p><p>See also <a href="#IncompressibleNavierStokes.stretched_grid"><code>stretched_grid</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/grid/cosine_grid.jl#L1-L13">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.get_dimension" href="#IncompressibleNavierStokes.get_dimension"><code>IncompressibleNavierStokes.get_dimension</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_dimension(grid)</code></pre><p>Get dimension of grid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/grid/get_dimension.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.max_size" href="#IncompressibleNavierStokes.max_size"><code>IncompressibleNavierStokes.max_size</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">max_size(grid)</code></pre><p>Get size of the largest grid element.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/grid/max_size.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.stretched_grid" href="#IncompressibleNavierStokes.stretched_grid"><code>IncompressibleNavierStokes.stretched_grid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">stretched_grid(a, b, N, s = 1)</code></pre><p>Create a nonuniform grid of <code>N + 1</code> points from <code>a</code> to <code>b</code> with a stretch factor of <code>s</code>. If <code>s = 1</code>, return a uniform spacing from <code>a</code> to <code>b</code>. Otherwise, return a vector <span>$x \in \mathbb{R}^{N + 1}$</span> such that <span>$x_n = a + \sum_{i = 1}^n s^{i - 1} h$</span> for <span>$n = 0, \dots , N$</span>. Setting <span>$x_N = b$</span> then gives <span>$h = (b - a) \frac{1 - s}{1 - s^N}$</span>, resulting in</p><p class="math-container">\[x_n = a + (b - a) \frac{1 - s^n}{1 - s^N}, \quad n = 0, \dots, N.\]</p><p>Note that <code>stretched_grid(a, b, N, s)[n]</code> corresponds to <span>$x_{n - 1}$</span>.</p><p>See also <a href="#IncompressibleNavierStokes.cosine_grid"><code>cosine_grid</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/grid/stretched_grid.jl#L1-L17">source</a></section></article><h2 id="Visocosity-Models"><a class="docs-heading-anchor" href="#Visocosity-Models">Visocosity Models</a><a id="Visocosity-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Visocosity-Models" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.AbstractViscosityModel" href="#IncompressibleNavierStokes.AbstractViscosityModel"><code>IncompressibleNavierStokes.AbstractViscosityModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractViscosityModel</code></pre><p>Abstract viscosity model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/models/viscosity_models.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.LaminarModel" href="#IncompressibleNavierStokes.LaminarModel"><code>IncompressibleNavierStokes.LaminarModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LaminarModel(Re)</code></pre><p>Laminar model with Reynolds number <code>Re</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/models/viscosity_models.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.KEpsilonModel" href="#IncompressibleNavierStokes.KEpsilonModel"><code>IncompressibleNavierStokes.KEpsilonModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">KEpsilonModel(Re)</code></pre><p>K-epsilon model with Reynolds number <code>Re</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/models/viscosity_models.jl#L17-L21">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.MixingLengthModel" href="#IncompressibleNavierStokes.MixingLengthModel"><code>IncompressibleNavierStokes.MixingLengthModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">MixingLengthModel(Re)</code></pre><p>Mixing-length model with Reynolds number <code>Re</code> and mixing length <code>lm</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/models/viscosity_models.jl#L26-L30">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.SmagorinskyModel" href="#IncompressibleNavierStokes.SmagorinskyModel"><code>IncompressibleNavierStokes.SmagorinskyModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SmagorinskyModel(Re, C_s = 0.17)</code></pre><p>Smagorinsky-Lilly model with Reynolds number <code>Re</code> and constant <code>C_s</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/models/viscosity_models.jl#L36-L40">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.QRModel" href="#IncompressibleNavierStokes.QRModel"><code>IncompressibleNavierStokes.QRModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">QR(Re)</code></pre><p>QR-model with Reynolds number <code>Re</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/models/viscosity_models.jl#L46-L50">source</a></section></article><h2 id="Convection-Models"><a class="docs-heading-anchor" href="#Convection-Models">Convection Models</a><a id="Convection-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Convection-Models" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.AbstractConvectionModel" href="#IncompressibleNavierStokes.AbstractConvectionModel"><code>IncompressibleNavierStokes.AbstractConvectionModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractConvectionModel</code></pre><p>Abstract convection model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/models/convection_models.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.NoRegConvectionModel" href="#IncompressibleNavierStokes.NoRegConvectionModel"><code>IncompressibleNavierStokes.NoRegConvectionModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">NoRegConvection()</code></pre><p>Unregularized convection model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/models/convection_models.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.C2ConvectionModel" href="#IncompressibleNavierStokes.C2ConvectionModel"><code>IncompressibleNavierStokes.C2ConvectionModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">C2ConvectionModel()</code></pre><p>C2 regularization convection model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/models/convection_models.jl#L15-L19">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.C4ConvectionModel" href="#IncompressibleNavierStokes.C4ConvectionModel"><code>IncompressibleNavierStokes.C4ConvectionModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">C4ConvectionModel()</code></pre><p>C4 regularization convection model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/models/convection_models.jl#L22-L26">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.LerayConvectionModel" href="#IncompressibleNavierStokes.LerayConvectionModel"><code>IncompressibleNavierStokes.LerayConvectionModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LerayConvectionModel()</code></pre><p>Leray regularization convection model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/models/convection_models.jl#L29-L33">source</a></section></article><h2 id="Momentum"><a class="docs-heading-anchor" href="#Momentum">Momentum</a><a id="Momentum-1"></a><a class="docs-heading-anchor-permalink" href="#Momentum" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.MomentumCache" href="#IncompressibleNavierStokes.MomentumCache"><code>IncompressibleNavierStokes.MomentumCache</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">MomentumCache</code></pre><p>Preallocation structure for terms in the momentum equations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/momentum/momentumcache.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.bodyforce" href="#IncompressibleNavierStokes.bodyforce"><code>IncompressibleNavierStokes.bodyforce</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">bodyforce(force, V, t, setup; get_jacobian = false)</code></pre><p>Compute body force <code>F</code> in momentum equations at velocity points.</p><p>Non-mutating/allocating/out-of-place version.</p><p>See also <a href="#IncompressibleNavierStokes.bodyforce!"><code>bodyforce!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/momentum/bodyforce.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.bodyforce!" href="#IncompressibleNavierStokes.bodyforce!"><code>IncompressibleNavierStokes.bodyforce!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">bodyforce!(force, F, t, setup)</code></pre><p>Compute body force <code>F</code> in momentum equations at velocity points.</p><p>Mutating/non-allocating/in-place version.</p><p>See also <a href="#IncompressibleNavierStokes.bodyforce"><code>bodyforce</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/momentum/bodyforce.jl#L31-L39">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.check_symmetry" href="#IncompressibleNavierStokes.check_symmetry"><code>IncompressibleNavierStokes.check_symmetry</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">check_symmetry(V, t, setup, ϵ = 1e-14)</code></pre><p>Check symmetry of convection operator.</p><p><code>flag = 0</code>: no symmetry error <code>flag = 1</code>: symmetry error</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/momentum/check_symmetry.jl#L1-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.compute_conservation" href="#IncompressibleNavierStokes.compute_conservation"><code>IncompressibleNavierStokes.compute_conservation</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">compute_conservation(V, t, setup; bc_vectors = nothing)</code></pre><p>Compute mass, momentum and energy conservation properties of velocity field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/momentum/compute_conservation.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.convection" href="#IncompressibleNavierStokes.convection"><code>IncompressibleNavierStokes.convection</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">convection(model, V, ϕ, setup; bc_vectors, get_jacobian = false)</code></pre><p>Evaluate convective terms <code>c</code> and, optionally, Jacobian <code>∇c = ∂c/∂V</code>, using the convection model <code>model</code>. The convected quantity is <code>ϕ</code> (usually <code>ϕ = V</code>).</p><p>Non-mutating/allocating/out-of-place version.</p><p>See also <a href="#IncompressibleNavierStokes.convection!"><code>convection!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/momentum/convection.jl#L1-L10">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.convection!" href="#IncompressibleNavierStokes.convection!"><code>IncompressibleNavierStokes.convection!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">convection!(model, c, ∇c, V, ϕ, setup, cache; bc_vectors, get_jacobian = false)</code></pre><p>Evaluate convective terms <code>c</code> and, optionally, Jacobian <code>∇c = ∂c/∂V</code>, using the convection model <code>model</code>. The convected quantity is <code>ϕ</code> (usually <code>ϕ = V</code>).</p><p>Mutating/non-allocating/in-place version.</p><p>See also <a href="#IncompressibleNavierStokes.convection"><code>convection</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/momentum/convection.jl#L357-L366">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.convection_components" href="#IncompressibleNavierStokes.convection_components"><code>IncompressibleNavierStokes.convection_components</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">convection_components(
    V, ϕ, setup;
    bc_vectors,
    get_jacobian = false,
    newton_factor = false,
    order4 = false,
)</code></pre><p>Compute convection components.</p><p>Non-mutating/allocating/out-of-place version.</p><p>See also <a href="#IncompressibleNavierStokes.convection_components!"><code>convection_components!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/momentum/convection_components.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.convection_components!" href="#IncompressibleNavierStokes.convection_components!"><code>IncompressibleNavierStokes.convection_components!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">convection_components!(
    c, ∇c, V, ϕ, setup, cache;
    bc_vectors,
    get_jacobian = false,
    newton_factor = false,
    order4 = false,
)</code></pre><p>Compute convection components.</p><p>Mutating/non-allocating/in-place version.</p><p>See also <a href="#IncompressibleNavierStokes.convection_components"><code>convection_components</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/momentum/convection_components.jl#L266-L280">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.diffusion" href="#IncompressibleNavierStokes.diffusion"><code>IncompressibleNavierStokes.diffusion</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">diffusion!(model, V, setup; bc_vectors, get_jacobian = false)</code></pre><p>Evaluate diffusive terms <code>d</code> and optionally Jacobian <code>∇d = ∂d/∂V</code> using viscosity model <code>model</code>.</p><p>Non-mutating/allocating/out-of-place version.</p><p>See also <a href="#IncompressibleNavierStokes.diffusion!"><code>diffusion!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/momentum/diffusion.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.diffusion!" href="#IncompressibleNavierStokes.diffusion!"><code>IncompressibleNavierStokes.diffusion!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">diffusion!(model, d, ∇d, V, setup; bc_vectors, get_jacobian = false)</code></pre><p>Evaluate diffusive terms <code>d</code> and optionally Jacobian <code>∇d = ∂d/∂V</code> using viscosity model <code>model</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/momentum/diffusion.jl#L118-L122">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.momentum" href="#IncompressibleNavierStokes.momentum"><code>IncompressibleNavierStokes.momentum</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">momentum(
    V, ϕ, p, t, setup;
    bc_vectors = nothing,
    get_jacobian = false,
    nopressure = false,
    newton_factor = false,
)</code></pre><p>Calculate RHS of momentum equations and, optionally, Jacobian with respect to velocity field.</p><ul><li><code>V</code>: velocity field</li><li><code>ϕ</code>: convected field: e.g. <span>$\frac{\partial (\phi_x V)}{\partial x} + \frac{\partial (\phi_y V)}{\partial y}$</span>; usually <code>ϕ = V</code> (so <code>ϕx = u</code>, <code>ϕy = v</code>)</li><li><code>p</code>: pressure</li><li><code>bc_vectors</code>: boundary condition vectors <code>y</code></li><li><code>get_jacobian</code>: return <code>∇F = ∂F/∂V</code></li><li><code>nopressure</code>: exclude pressure gradient; in this case input argument <code>p</code> is not used</li><li><code>newton_factor</code></li></ul><p>Non-mutating/allocating/out-of-place version.</p><p>See also <a href="#IncompressibleNavierStokes.momentum!"><code>momentum!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/momentum/momentum.jl#L1-L23">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.momentum!" href="#IncompressibleNavierStokes.momentum!"><code>IncompressibleNavierStokes.momentum!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">momentum!(F, ∇F, V, ϕ, p, t, setup, cache; get_jacobian = false, nopressure = false)</code></pre><p>Calculate rhs of momentum equations and, optionally, Jacobian with respect to velocity field.</p><ul><li><code>V</code>: velocity field</li><li><code>ϕ</code>: convected field: e.g. <span>$\frac{\partial (\phi_x V)}{\partial x} + \frac{\partial (\phi_y V)}{\partial y}$</span>; usually <code>ϕ = V</code> (so <code>ϕx = u</code>, <code>ϕy = v</code>)</li><li><code>p</code>: pressure</li><li><code>bc_vectors</code>: boundary condition vectors <code>y</code></li><li><code>get_jacobian</code>: return <code>∇F = ∂F/∂V</code></li><li><code>nopressure</code>: exclude pressure gradient; in this case input argument <code>p</code> is not used</li><li><code>newton_factor</code></li></ul><p>Mutating/non-allocating/in-place version.</p><p>See also <a href="#IncompressibleNavierStokes.momentum"><code>momentum</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/momentum/momentum.jl#L74-L90">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.momentum_allstage" href="#IncompressibleNavierStokes.momentum_allstage"><code>IncompressibleNavierStokes.momentum_allstage</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">momentum_allstage(V, C, p, t, setup; get_jacobian = false)</code></pre><p>Call momentum for multiple <code>(V, p)</code> pairs, as required in implicit RK methods.</p><p>Non-mutating/allocating/out-of-place version.</p><p>See also <a href="#IncompressibleNavierStokes.momentum_allstage!"><code>momentum_allstage!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/step_implicit_runge_kutta.jl#L423-L431">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.momentum_allstage!" href="#IncompressibleNavierStokes.momentum_allstage!"><code>IncompressibleNavierStokes.momentum_allstage!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">momentum_allstage!(F, ∇F, V, C, p, t, setup, cache, momentum_cache; get_jacobian = false)</code></pre><p>Call momentum for multiple <code>(V, p)</code> pairs, as required in implicit RK methods.</p><p>Mutating/non-allocating/in-place version.</p><p>See also <a href="#IncompressibleNavierStokes.momentum_allstage"><code>momentum_allstage</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/step_implicit_runge_kutta.jl#L460-L468">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.strain_tensor" href="#IncompressibleNavierStokes.strain_tensor"><code>IncompressibleNavierStokes.strain_tensor</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">strain_tensor(V, setup; bc_vectors, get_jacobian = false, get_S_abs = false)</code></pre><p>Evaluate rate of strain tensor <code>S(V)</code> and its magnitude.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/momentum/strain_tensor.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.turbulent_K" href="#IncompressibleNavierStokes.turbulent_K"><code>IncompressibleNavierStokes.turbulent_K</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">turbulent_K(model, setup)</code></pre><p>Compute the constant part of the turbulent viscosity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/momentum/turbulent_K.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.turbulent_viscosity" href="#IncompressibleNavierStokes.turbulent_viscosity"><code>IncompressibleNavierStokes.turbulent_viscosity</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">turbulent_viscosity(model, setup, S_abs)</code></pre><p>Compute turbulent viscosity based on <code>S_abs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/momentum/turbulent_viscosity.jl#L1-L5">source</a></section></article><h2 id="Operators"><a class="docs-heading-anchor" href="#Operators">Operators</a><a id="Operators-1"></a><a class="docs-heading-anchor-permalink" href="#Operators" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.Operators" href="#IncompressibleNavierStokes.Operators"><code>IncompressibleNavierStokes.Operators</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Operators()</code></pre><p>Discrete operators.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/operators/operators.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.ke_convection" href="#IncompressibleNavierStokes.ke_convection"><code>IncompressibleNavierStokes.ke_convection</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ke_convection(grid, boundary_conditions)</code></pre><p>K-epsilon convection.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/operators/ke_convection.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.ke_diffusion" href="#IncompressibleNavierStokes.ke_diffusion"><code>IncompressibleNavierStokes.ke_diffusion</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ke_diffusion(grid, boundary_conditions)</code></pre><p>K-epsilon diffusion.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/operators/ke_diffusion.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.ke_production" href="#IncompressibleNavierStokes.ke_production"><code>IncompressibleNavierStokes.ke_production</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ke_production(grid, boundary_conditions)</code></pre><p>Differencing velocity to k-points.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/operators/ke_production.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.ke_viscosity" href="#IncompressibleNavierStokes.ke_viscosity"><code>IncompressibleNavierStokes.ke_viscosity</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ke_viscosity(grid, boundary_conditions)</code></pre><p>Average (turbulent) viscosity to cell faces.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/operators/ke_viscosity.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.operator_averaging" href="#IncompressibleNavierStokes.operator_averaging"><code>IncompressibleNavierStokes.operator_averaging</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">operator_averaging(grid, boundary_conditions)</code></pre><p>Construct averaging operators.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/operators/operator_averaging.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.operator_convection_diffusion" href="#IncompressibleNavierStokes.operator_convection_diffusion"><code>IncompressibleNavierStokes.operator_convection_diffusion</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">operator_convection_diffusion(grid, boundary_conditions, viscosity_model)</code></pre><p>Construct convection and diffusion operators.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/operators/operator_convection_diffusion.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.operator_divergence" href="#IncompressibleNavierStokes.operator_divergence"><code>IncompressibleNavierStokes.operator_divergence</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">operator_divergence(grid, boundary_conditions)</code></pre><p>Construct divergence and gradient operator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/operators/operator_divergence.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.operator_interpolation" href="#IncompressibleNavierStokes.operator_interpolation"><code>IncompressibleNavierStokes.operator_interpolation</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">operator_interpolation(grid, boundary_conditions)</code></pre><p>Construct averaging operators.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/operators/operator_interpolation.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.operator_postprocessing" href="#IncompressibleNavierStokes.operator_postprocessing"><code>IncompressibleNavierStokes.operator_postprocessing</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">operator_postprocessing(grid, boundary_conditions)</code></pre><p>Construct postprocessing operators such as vorticity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/operators/operator_postprocessing.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.operator_regularization" href="#IncompressibleNavierStokes.operator_regularization"><code>IncompressibleNavierStokes.operator_regularization</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">operator_regularization(grid)</code></pre><p>Build regularization matrices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/operators/operator_regularization.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.operator_turbulent_diffusion" href="#IncompressibleNavierStokes.operator_turbulent_diffusion"><code>IncompressibleNavierStokes.operator_turbulent_diffusion</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">operator_turbulent_diffusion(grid, boundary_conditions)</code></pre><p>Average (turbulent) viscosity to cell faces: from <code>ν</code> at <code>xp</code>, <code>yp</code> to <code>ν</code> at <code>ux</code>, <code>uy</code>, <code>vx</code>, <code>vy</code> locations.</p><p>See also <code>ke_viscosity.jl</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/operators/operator_turbulent_diffusion.jl#L1-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.operator_viscosity" href="#IncompressibleNavierStokes.operator_viscosity"><code>IncompressibleNavierStokes.operator_viscosity</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">operator_viscosity(model, grid, boundary_conditions)</code></pre><p>Classical turbulence modelling via the diffusive term</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/operators/operator_viscosity.jl#L1-L5">source</a></section></article><h2 id="Postprocess"><a class="docs-heading-anchor" href="#Postprocess">Postprocess</a><a id="Postprocess-1"></a><a class="docs-heading-anchor-permalink" href="#Postprocess" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.get_streamfunction" href="#IncompressibleNavierStokes.get_streamfunction"><code>IncompressibleNavierStokes.get_streamfunction</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_streamfunction(V, t, setup)</code></pre><p>Compute streamfunction <span>$\psi$</span> from a Poisson equation <span>$\nabla^2 \psi = -\omega$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/postprocess/get_streamfunction.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.get_velocity" href="#IncompressibleNavierStokes.get_velocity"><code>IncompressibleNavierStokes.get_velocity</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_velocity(V, t, setup)</code></pre><p>Get velocity values at pressure points. Interpolate velocities to pressure positions using <code>BMx</code> and <code>BMy</code> (and <code>BMz</code>), constructed in operator_divergence.jl.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/postprocess/get_velocity.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.get_vorticity" href="#IncompressibleNavierStokes.get_vorticity"><code>IncompressibleNavierStokes.get_vorticity</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_vorticity(V, t, setup)</code></pre><p>Get vorticity from velocity field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/postprocess/get_vorticity.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.vorticity!" href="#IncompressibleNavierStokes.vorticity!"><code>IncompressibleNavierStokes.vorticity!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">vorticity!(ω, V, t, setup)</code></pre><p>Compute vorticity values at pressure midpoints. This should be consistent with <code>operator_postprocessing.jl</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/postprocess/get_vorticity.jl#L53-L58">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.plot_force" href="#IncompressibleNavierStokes.plot_force"><code>IncompressibleNavierStokes.plot_force</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plot_force(setup, t; kwargs...)</code></pre><p>Plot body force.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/postprocess/plot_force.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.plot_grid" href="#IncompressibleNavierStokes.plot_grid"><code>IncompressibleNavierStokes.plot_grid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plot_grid(x, y)
plot_grid(x, y, z)
plot_grid(grid)</code></pre><p>Plot nonuniform Cartesian grid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/postprocess/plot_grid.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.plot_pressure" href="#IncompressibleNavierStokes.plot_pressure"><code>IncompressibleNavierStokes.plot_pressure</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plot_pressure(setup, p; kwargs...)</code></pre><p>Plot pressure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/postprocess/plot_pressure.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.plot_streamfunction" href="#IncompressibleNavierStokes.plot_streamfunction"><code>IncompressibleNavierStokes.plot_streamfunction</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plot_streamfunction(setup, V, t; kwargs...)</code></pre><p>Plot streamfunction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/postprocess/plot_streamfunction.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.plot_tracers" href="#IncompressibleNavierStokes.plot_tracers"><code>IncompressibleNavierStokes.plot_tracers</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plot_tracers(tracer)</code></pre><p>Plot tracer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/postprocess/plot_tracers.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.plot_velocity" href="#IncompressibleNavierStokes.plot_velocity"><code>IncompressibleNavierStokes.plot_velocity</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plot_velocity(setup, V, t; kwargs...)</code></pre><p>Plot velocity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/postprocess/plot_velocity.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.plot_vorticity" href="#IncompressibleNavierStokes.plot_vorticity"><code>IncompressibleNavierStokes.plot_vorticity</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plot_vorticity(setup, V, t; kwargs...)</code></pre><p>Plot vorticity field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/postprocess/plot_vorticity.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.save_vtk" href="#IncompressibleNavierStokes.save_vtk"><code>IncompressibleNavierStokes.save_vtk</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">save_vtk(V, p, t, setup, filename = &quot;output/solution&quot;)</code></pre><p>Save velocity and pressure field to a VTK file.</p><p>In the case of a 2D setup, the velocity field is saved as a 3D vector with a z-component of zero, as this seems to be preferred by ParaView.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/postprocess/save_vtk.jl#L1-L8">source</a></section></article><h2 id="Preprocess"><a class="docs-heading-anchor" href="#Preprocess">Preprocess</a><a id="Preprocess-1"></a><a class="docs-heading-anchor-permalink" href="#Preprocess" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.create_initial_conditions" href="#IncompressibleNavierStokes.create_initial_conditions"><code>IncompressibleNavierStokes.create_initial_conditions</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">create_initial_conditions(
    setup,
    t;
    initial_velocity_u,
    initial_velocity_v,
    [initial_velocity_w,]
    initial_pressure = nothing,
    pressure_solver = DirectPressureSolver(setup),
)</code></pre><p>Create initial vectors at starting time <code>t</code>. If <code>p_initial</code> is a function instead of <code>nothing</code>, calculate compatible IC for the pressure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/preprocess/create_initial_conditions.jl#L1-L14">source</a></section></article><h2 id="Problems"><a class="docs-heading-anchor" href="#Problems">Problems</a><a id="Problems-1"></a><a class="docs-heading-anchor-permalink" href="#Problems" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.SteadyStateProblem" href="#IncompressibleNavierStokes.SteadyStateProblem"><code>IncompressibleNavierStokes.SteadyStateProblem</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SteadyStateProblem(setup, V₀, p₀)</code></pre><p>Steady state problem. The solution <code>V</code> and <code>p</code> should be such that <span>$\frac{\partial \mathbf{V}}{\partial t} = \mathbf{0}$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/problems/problems.jl#L3-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.UnsteadyProblem" href="#IncompressibleNavierStokes.UnsteadyProblem"><code>IncompressibleNavierStokes.UnsteadyProblem</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">UnsteadyProblem(setup, V₀, p₀, (t_start, t_stop))</code></pre><p>Unsteady problem with initial conditions <code>V₀</code>, <code>p₀</code> to be solved from <code>t_start</code> to <code>t_stop</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/problems/problems.jl#L15-L19">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.is_steady" href="#IncompressibleNavierStokes.is_steady"><code>IncompressibleNavierStokes.is_steady</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">is_steady(problem)</code></pre><p>Returns <code>true</code> if problem is unsteady.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/problems/is_steady.jl#L1-L5">source</a></section></article><h2 id="Processors"><a class="docs-heading-anchor" href="#Processors">Processors</a><a id="Processors-1"></a><a class="docs-heading-anchor-permalink" href="#Processors" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.AbstractProcessor" href="#IncompressibleNavierStokes.AbstractProcessor"><code>IncompressibleNavierStokes.AbstractProcessor</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractProcessor</code></pre><p>Abstract iteration processor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/processors/processors.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.Logger" href="#IncompressibleNavierStokes.Logger"><code>IncompressibleNavierStokes.Logger</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Logger(nupdate)</code></pre><p>Print time stepping information after every time step.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/processors/processors.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.RealTimePlotter" href="#IncompressibleNavierStokes.RealTimePlotter"><code>IncompressibleNavierStokes.RealTimePlotter</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">RealTimePlotter(; nupdate, fieldname, type = heatmap)</code></pre><p>Plot the solution every <code>nupdate</code> time steps. Available fieldnames are:</p><ul><li><code>:velocity</code>,</li><li><code>:vorticity</code>,</li><li><code>:streamfunction</code>,</li><li><code>:pressure</code>.</li></ul><p>Available plot <code>type</code>s are:</p><ul><li><code>heatmap</code>,</li><li><code>contour</code>,</li><li><code>contourf</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/processors/processors.jl#L17-L32">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.VTKWriter" href="#IncompressibleNavierStokes.VTKWriter"><code>IncompressibleNavierStokes.VTKWriter</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">VTKWriter(; nupdate, dir = &quot;output&quot;, filename = &quot;solution&quot;)</code></pre><p>Write the solution every <code>nupdate</code> time steps to a VTK file. The resulting Paraview data collection file is stored in <code>&quot;$dir/$filename.pvd&quot;</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/processors/processors.jl#L41-L46">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.QuantityTracer" href="#IncompressibleNavierStokes.QuantityTracer"><code>IncompressibleNavierStokes.QuantityTracer</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">QuantityTracer(nupdate)</code></pre><p>Store scalar quantities (maximum divergence, momentum, kinetic energy) every <code>nupdate</code> time steps.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/processors/processors.jl#L54-L59">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.initialize!" href="#IncompressibleNavierStokes.initialize!"><code>IncompressibleNavierStokes.initialize!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">initialize!(processor, stepper)</code></pre><p>Initialize processor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/processors/initialize.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.process!" href="#IncompressibleNavierStokes.process!"><code>IncompressibleNavierStokes.process!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">process!(processor, stepper)</code></pre><p>Process iteration.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/processors/process.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.finalize!" href="#IncompressibleNavierStokes.finalize!"><code>IncompressibleNavierStokes.finalize!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">finalize!(processor)</code></pre><p>Finalize processing after iterations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/processors/finalize.jl#L1-L5">source</a></section></article><h2 id="Solvers"><a class="docs-heading-anchor" href="#Solvers">Solvers</a><a id="Solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Solvers" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.get_timestep" href="#IncompressibleNavierStokes.get_timestep"><code>IncompressibleNavierStokes.get_timestep</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_timestep(stepper, cfl; bc_vectors)</code></pre><p>Estimate time step based on eigenvalues of operators, using Gershgorin.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/solvers/get_timestep.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.solve" href="#IncompressibleNavierStokes.solve"><code>IncompressibleNavierStokes.solve</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">solve(
    problem::SteadyStateProblem;
    jacobian_type = :newton,
    npicard = 2,
    abstol = 1e-10,
    maxiter = 10,
)</code></pre><p>Solve steady state problem of the Navier-Stokes equations. This saddlepoint system arises from linearization of the convective terms.</p><p>Each <code>processor</code> is called after every <code>processor.nupdate</code> iteration.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/solvers/solve_steady_state.jl#L1-L14">source</a></section><section><div><pre><code class="nohighlight hljs">solve(
    problem::UnsteadyProblem,
    method;
    pressure_solver = DirectPressureSolver(problem.setup),
    Δt = nothing,
    cfl = 1,
    n_adapt_Δt = 1,
    nstartup = 1,
    method_startup = nothing,
    inplace = false,
    processors = [],
)</code></pre><p>Solve unsteady problem using <code>method</code>.</p><p>If <code>Δt</code> is a real number, it is rounded such that <code>(t_end - t_start) / Δt</code> is an integer. If <code>Δt = nothing</code>, the time step is chosen every <code>n_adapt_Δt</code> iteration with CFL-number <code>cfl</code> .</p><p>For methods that are not self-starting, <code>nstartup</code> startup iterations are performed with <code>method_startup</code>.</p><p>Each <code>processor</code> is called after every <code>processor.nupdate</code> time step.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/solvers/solve_unsteady.jl#L1-L26">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.solve_animate" href="#IncompressibleNavierStokes.solve_animate"><code>IncompressibleNavierStokes.solve_animate</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">solve_animate(
    problem::UnsteadyProblem,
    method;
    pressure_solver = DirectPressureSolver(problem.setup),
    Δt = nothing,
    cfl = 1,
    n_adapt_Δt = 1,
    method_startup = nothing,
    nstartup = 1,
    animator = RealTimePlotter(),
    filename = &quot;vorticity.gif&quot;,
    nframe = 200,
    nsubframe = 4,
    framerate = 20,
)</code></pre><p>Solve unsteady problem using <code>method</code>.</p><p>If <code>Δt</code> is a real number, it is rounded such that <code>(t_end - t_start) / Δt</code> is an integer. If <code>Δt = nothing</code>, the time step is chosen every <code>n_adapt_Δt</code> iteration with CFL-number <code>cfl</code> .</p><p>For methods that are not self-starting, <code>nstartup</code> startup iterations are performed with <code>method_startup</code>.</p><p>Each <code>processor</code> is called after every <code>processor.nupdate</code> time step.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/solvers/solve_animate.jl#L1-L29">source</a></section></article><h3 id="Pressure-solvers"><a class="docs-heading-anchor" href="#Pressure-solvers">Pressure solvers</a><a id="Pressure-solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Pressure-solvers" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.AbstractPressureSolver" href="#IncompressibleNavierStokes.AbstractPressureSolver"><code>IncompressibleNavierStokes.AbstractPressureSolver</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractPressureSolver</code></pre><p>Pressure solver for the Poisson equation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/solvers/pressure/pressure_solvers.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.DirectPressureSolver" href="#IncompressibleNavierStokes.DirectPressureSolver"><code>IncompressibleNavierStokes.DirectPressureSolver</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DirectPressureSolver()</code></pre><p>Direct pressure solver using a LU decomposition.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/solvers/pressure/pressure_solvers.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.CGPressureSolver" href="#IncompressibleNavierStokes.CGPressureSolver"><code>IncompressibleNavierStokes.CGPressureSolver</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">CGPressureSolver(abstol, reltol, maxiter)</code></pre><p>Conjugate gradients iterative pressure solver.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/solvers/pressure/pressure_solvers.jl#L21-L25">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.FourierPressureSolver" href="#IncompressibleNavierStokes.FourierPressureSolver"><code>IncompressibleNavierStokes.FourierPressureSolver</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">FourierPressureSolver()</code></pre><p>Fourier transform pressure solver for periodic domains.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/solvers/pressure/pressure_solvers.jl#L43-L47">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.pressure_additional_solve" href="#IncompressibleNavierStokes.pressure_additional_solve"><code>IncompressibleNavierStokes.pressure_additional_solve</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">pressure_additional_solve(pressure_solver, V, p, t, setup; bc_vectors = nothing)</code></pre><p>Do additional pressure solve. This makes the pressure compatible with the velocity field, resulting in same order pressure as velocity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/solvers/pressure/pressure_additional_solve.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.pressure_additional_solve!" href="#IncompressibleNavierStokes.pressure_additional_solve!"><code>IncompressibleNavierStokes.pressure_additional_solve!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">pressure_additional_solve!(pressure_solver, V, p, t, setup, momentum_cache, F, f; bc_vectors)</code></pre><p>Do additional pressure solve. This makes the pressure compatible with the velocity field, resulting in same order pressure as velocity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/solvers/pressure/pressure_additional_solve.jl#L29-L34">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.pressure_poisson" href="#IncompressibleNavierStokes.pressure_poisson"><code>IncompressibleNavierStokes.pressure_poisson</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">pressure_poisson(solver, f, setup)</code></pre><p>Solve the Poisson equation for the pressure with right hand side <code>f</code> at time <code>t</code>. For periodic and no-slip BC, the sum of <code>f</code> should be zero.</p><p>Non-mutating/allocating/out-of-place version.</p><p>See also <a href="#IncompressibleNavierStokes.pressure_poisson!"><code>pressure_poisson!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/solvers/pressure/pressure_poisson.jl#L1-L10">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.pressure_poisson!" href="#IncompressibleNavierStokes.pressure_poisson!"><code>IncompressibleNavierStokes.pressure_poisson!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">pressure_poisson!(solver, p, f)</code></pre><p>Solve the Poisson equation for the pressure with right hand side <code>f</code> at time <code>t</code>. For periodic and no-slip BC, the sum of <code>f</code> should be zero.</p><p>Mutating/non-allocating/in-place version.</p><p>See also <a href="#IncompressibleNavierStokes.pressure_poisson"><code>pressure_poisson</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/solvers/pressure/pressure_poisson.jl#L42-L51">source</a></section></article><h2 id="Time-steppers"><a class="docs-heading-anchor" href="#Time-steppers">Time steppers</a><a id="Time-steppers-1"></a><a class="docs-heading-anchor-permalink" href="#Time-steppers" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.AbstractODEMethod" href="#IncompressibleNavierStokes.AbstractODEMethod"><code>IncompressibleNavierStokes.AbstractODEMethod</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractODEMethod</code></pre><p>Abstract ODE method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/methods.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.AbstractRungeKuttaMethod" href="#IncompressibleNavierStokes.AbstractRungeKuttaMethod"><code>IncompressibleNavierStokes.AbstractRungeKuttaMethod</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractRungeKuttaMethod</code></pre><p>Abstract Runge Kutta method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/methods.jl#L74-L78">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.AdamsBashforthCrankNicolsonMethod" href="#IncompressibleNavierStokes.AdamsBashforthCrankNicolsonMethod"><code>IncompressibleNavierStokes.AdamsBashforthCrankNicolsonMethod</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AdamsBashforthCrankNicolsonMethod(; α₁ = 3 // 2, α₂ = -1 // 2, θ = 1 // 2, p_add_solve = true)</code></pre><p>IMEX AB-CN: Adams-Bashforth for explicit convection (parameters <code>α₁</code> and <code>α₂</code>) and Crank-Nicolson for implicit diffusion (implicitness <code>θ</code>). The method is second order for <code>θ = 1/2</code>.</p><p>Adams-Bashforth for convection and Crank-Nicolson for diffusion formulation:</p><p class="math-container">\[\begin{align*}
(\mathbf{u}^{n+1} - \mathbf{u}^n) / Δt &amp; =
    -(\alpha_1 \mathbf{c}^n + \alpha_2 \mathbf{c}^{n-1}) \\
    &amp; + \theta \mathbf{d}^{n+1} + (1-\theta) \mathbf{d}^n \\
    &amp; + \theta \mathbf{F}^{n+1} + (1-\theta) \mathbf{F}^n \\
    &amp; + \theta \mathbf{BC}^{n+1} + (1-\theta) \mathbf{BC}^n \\
    &amp; - \mathbf{G} \mathbf{p} + \mathbf{y}_p
\end{align*}\]</p><p>where BC are boundary conditions of diffusion. This is rewritten as:</p><p class="math-container">\[\begin{align*}
(\frac{1}{\Delta t} \mathbf{I} - \theta \mathbf{D}) \mathbf{u}^{n+1} &amp; =
    (\frac{1}{\Delta t} \mathbf{I} - (1 - \theta) \mathbf{D}) \mathbf{u}^{n} \\
    &amp; - (\alpha_1 \mathbf{c}^n + \alpha_2 \mathbf{c}^{n-1}) \\
    &amp; + \theta \mathbf{F}^{n+1} + (1-\theta) \mathbf{F}^{n} \\
    &amp; + \theta \mathbf{BC}^{n+1} + (1-\theta) \mathbf{BC}^{n} \\
    &amp; - \mathbf{G} \mathbf{p} + \mathbf{y}_p
\end{align*}\]</p><p>The LU decomposition of the LHS matrix is precomputed in <code>operator_convection_diffusion.jl</code>.</p><p>Note that, in constrast to explicit methods, the pressure from previous time steps has an influence on the accuracy of the velocity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/methods.jl#L8-L47">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.OneLegMethod" href="#IncompressibleNavierStokes.OneLegMethod"><code>IncompressibleNavierStokes.OneLegMethod</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">OneLegMethod(; β = 1 // 2, p_add_solve = true)</code></pre><p>Explicit one-leg β-method following symmetry-preserving discretization of turbulent flow. See [Verstappen and Veldman (JCP 2003)] for details, or [Direct numerical simulation of turbulence at lower costs (Journal of Engineering Mathematics 1997)].</p><p>Formulation:</p><p class="math-container">\[\frac{(\beta + 1/2) u^{n+1} - 2 \beta u^{n} + (\beta - 1/2) u^{n-1}}{\Delta t} = F((1 +
\beta) u^n - \beta u^{n-1}).\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/methods.jl#L55-L68">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.ExplicitRungeKuttaMethod" href="#IncompressibleNavierStokes.ExplicitRungeKuttaMethod"><code>IncompressibleNavierStokes.ExplicitRungeKuttaMethod</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ExplicitRungeKuttaMethod(; A, b, c, r, p_add_solve = true)</code></pre><p>Explicit Runge Kutta method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/methods.jl#L81-L85">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.ImplicitRungeKuttaMethod" href="#IncompressibleNavierStokes.ImplicitRungeKuttaMethod"><code>IncompressibleNavierStokes.ImplicitRungeKuttaMethod</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ImplicitRungeKuttaMethod(;
    A,
    b,
    c,
    r,
    newton_type = :full,
    maxiter = 10,
    abstol = 1e-14,
    reltol = 1e-14,
    p_add_solve = true,
)</code></pre><p>Implicit Runge Kutta method.</p><p>The implicit linear system is solved at each time step using Newton&#39;s method. The <code>newton_type</code> may be one of the following:</p><ul><li><code>:no</code>: Replace iteration matrix with I/Δt (no Jacobian)</li><li><code>:approximate</code>: Build Jacobian once before iterations only</li><li><code>:full</code>: Build Jacobian at each iteration</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/methods.jl#L94-L115">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.TimeStepper" href="#IncompressibleNavierStokes.TimeStepper"><code>IncompressibleNavierStokes.TimeStepper</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">TimeStepper</code></pre><p>Time stepper for solving ODEs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/time_steppers.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.AbstractODEMethodCache" href="#IncompressibleNavierStokes.AbstractODEMethodCache"><code>IncompressibleNavierStokes.AbstractODEMethodCache</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractODEMethodCache</code></pre><p>ODE method cache.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/time_stepper_caches.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.ExplicitRungeKuttaCache" href="#IncompressibleNavierStokes.ExplicitRungeKuttaCache"><code>IncompressibleNavierStokes.ExplicitRungeKuttaCache</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ExplicitRungeKuttaCache(; kwargs...)</code></pre><p>Explicit Runge-Kutta cache.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/time_stepper_caches.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.ImplicitRungeKuttaCache" href="#IncompressibleNavierStokes.ImplicitRungeKuttaCache"><code>IncompressibleNavierStokes.ImplicitRungeKuttaCache</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ImplicitRungeKuttaCache(; kwargs...)</code></pre><p>Implicit Runge-Kutta cache.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/time_stepper_caches.jl#L24-L28">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.AdamsBashforthCrankNicolsonCache" href="#IncompressibleNavierStokes.AdamsBashforthCrankNicolsonCache"><code>IncompressibleNavierStokes.AdamsBashforthCrankNicolsonCache</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AdamsBashforthCrankNicolsonCache(; kwargs...)</code></pre><p>Adams-Bashforth Crank-Nicolson cache.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/time_stepper_caches.jl#L54-L58">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.OneLegCache" href="#IncompressibleNavierStokes.OneLegCache"><code>IncompressibleNavierStokes.OneLegCache</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">OneLegCache(; kwargs...)</code></pre><p>One-leg cache.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/time_stepper_caches.jl#L76-L80">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.change_time_stepper" href="#IncompressibleNavierStokes.change_time_stepper"><code>IncompressibleNavierStokes.change_time_stepper</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">change_time_stepper(stepper, method) -&gt; TimeStepper</code></pre><p>Change ODE method. Return a new stepper.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/change_time_stepper.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.isexplicit" href="#IncompressibleNavierStokes.isexplicit"><code>IncompressibleNavierStokes.isexplicit</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">isexplicit(method)</code></pre><p>Return <code>true</code> if <code>method</code> is explicit, i.e. the value at a certain time step is given explicitly as a function of the previous time steps onl is given explicitly as a function of the previous time steps only.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/isexplicit.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.lambda_conv_max" href="#IncompressibleNavierStokes.lambda_conv_max"><code>IncompressibleNavierStokes.lambda_conv_max</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">lambda_conv_max(method)</code></pre><p>Get maximum value of stability region for the convection operator (not a very good indication for the methods that do not include the imaginary axis)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/lambda_max.jl#L11-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.lambda_diff_max" href="#IncompressibleNavierStokes.lambda_diff_max"><code>IncompressibleNavierStokes.lambda_diff_max</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">lambda_diff_max(method)</code></pre><p>Get maximum value of stability region for the diffusion operator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/lambda_max.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.needs_startup_method" href="#IncompressibleNavierStokes.needs_startup_method"><code>IncompressibleNavierStokes.needs_startup_method</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">needs_startup_method(method)</code></pre><p>Return <code>true</code> if <code>method</code> needs a startup method to generate an initial history.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/needs_startup_method.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.nstage" href="#IncompressibleNavierStokes.nstage"><code>IncompressibleNavierStokes.nstage</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">nstage(rk_method)</code></pre><p>Get number of stages of the Runge-Kutta method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/nstage.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.ode_method_cache" href="#IncompressibleNavierStokes.ode_method_cache"><code>IncompressibleNavierStokes.ode_method_cache</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ode_method_cache(method, setup)</code></pre><p>Get time stepper cache for the given ODE method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/time_stepper_caches.jl#L90-L94">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.runge_kutta_method" href="#IncompressibleNavierStokes.runge_kutta_method"><code>IncompressibleNavierStokes.runge_kutta_method</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">runge_kutta_method(A, b, c, r; [p_add_solve], [newton_type], [maxiter], [abstol], [reltol])</code></pre><p>Get Runge Kutta method. The function checks whether the method is explicit.</p><p><code>p_add_solve</code>: whether to add a pressure solve step to the method.</p><p>For implicit RK methods: <code>newton_type</code>, <code>maxiter</code>, <code>abstol</code>, <code>reltol</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/methods.jl#L128-L136">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.step" href="#IncompressibleNavierStokes.step"><code>IncompressibleNavierStokes.step</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">step(stepper::AdamsBashforthCrankNicolsonStepper, Δt; bc_vectors = nothing)</code></pre><p>Perform one time step with Adams-Bashforth for convection and Crank-Nicolson for diffusion.</p><p>Output includes convection terms at <code>tₙ</code>, which will be used in next time step in the Adams-Bashforth part of the method.</p><p>Non-mutating/allocating/out-of-place version.</p><p>See also <a href="#IncompressibleNavierStokes.step!"><code>step!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/step_ab_cn.jl#L1-L12">source</a></section><section><div><pre><code class="nohighlight hljs">step(stepper::OneLegStepper, Δt; bc_vectors = nothing)</code></pre><p>Do one time step using one-leg-β-method.</p><p>Non-mutating/allocating/out-of-place version.</p><p>See also <a href="#IncompressibleNavierStokes.step!"><code>step!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/step_one_leg.jl#L1-L9">source</a></section><section><div><pre><code class="nohighlight hljs">step(stepper::ExplicitRungeKuttaStepper, Δt; bc_vectors = nothing)</code></pre><p>Perform one time step for the general explicit Runge-Kutta method (ERK).</p><p>Dirichlet boundary points are not part of solution vector but are prescribed in a strong manner via the <code>u_bc</code> and <code>v_bc</code> functions.</p><p>Non-mutating/allocating/out-of-place version.</p><p>See also <a href="#IncompressibleNavierStokes.step!"><code>step!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/step_explicit_runge_kutta.jl#L1-L12">source</a></section><section><div><pre><code class="nohighlight hljs">step(stepper::ImplicitRungeKuttaStepper, Δt; bc_vectors = nothing)</code></pre><p>Do one time step for implicit Runge-Kutta method.</p><p>Unsteady Dirichlet boundary points are not part of solution vector but are prescribed in a &quot;strong&quot; manner via the <code>u_bc</code> and <code>v_bc</code> functions.</p><p>Non-mutating/allocating/out-of-place version.</p><p>See also <a href="#IncompressibleNavierStokes.step!"><code>step!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/step_implicit_runge_kutta.jl#L1-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.step!" href="#IncompressibleNavierStokes.step!"><code>IncompressibleNavierStokes.step!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">step!(stepper::AdamsBashforthCrankNicolsonStepper, Δt; cache, momentum_cache, bc_vectors = nothing)</code></pre><p>Perform one time step with Adams-Bashforth for convection and Crank-Nicolson for diffusion.</p><p>Output includes convection terms at <code>tₙ</code>, which will be used in next time step in the Adams-Bashforth part of the method.</p><p>Mutating/non-allocating/in-place version.</p><p>See also <a href="#IncompressibleNavierStokes.step"><code>step</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/step_ab_cn.jl#L114-L125">source</a></section><section><div><pre><code class="nohighlight hljs">step!(stepper::OneLegStepper, Δt; cache, momentum_cache, bc_vectors = nothing)</code></pre><p>Do one time step using one-leg-β-method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/step_one_leg.jl#L74-L78">source</a></section><section><div><pre><code class="nohighlight hljs">step!(stepper::ExplicitRungeKuttaStepper, Δt; cache, momentum_cache, bc_vectors = nothing)</code></pre><p>Perform one time step for the general explicit Runge-Kutta method (ERK).</p><p>Dirichlet boundary points are not part of solution vector but are prescribed in a strong manner via the <code>u_bc</code> and <code>v_bc</code> functions.</p><p>Mutating/non-allocating/in-place version.</p><p>See also <a href="#IncompressibleNavierStokes.step"><code>step</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/step_explicit_runge_kutta.jl#L94-L105">source</a></section><section><div><pre><code class="nohighlight hljs">step!(stepper::ImplicitRungeKuttaStepper, Δt; cache, momentum_cache, bc_vectors = nothing)</code></pre><p>Do one time step for implicit Runge-Kutta method.</p><p>Unsteady Dirichlet boundary points are not part of solution vector but are prescribed in a &quot;strong&quot; manner via the <code>u_bc</code> and <code>v_bc</code> functions.</p><p>Mutating/non-allocating/in-place version.</p><p>See also <a href="#IncompressibleNavierStokes.step"><code>step</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/time_steppers/step_implicit_runge_kutta.jl#L174-L185">source</a></section></article><h2 id="Utils"><a class="docs-heading-anchor" href="#Utils">Utils</a><a id="Utils-1"></a><a class="docs-heading-anchor-permalink" href="#Utils" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.filter_convection" href="#IncompressibleNavierStokes.filter_convection"><code>IncompressibleNavierStokes.filter_convection</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">filter_convection(u, diff_matrix, bc, α)</code></pre><p>Construct filter for convective terms.</p><p>Non-mutating/allocating/out-of-place version.</p><p>See also <a href="#IncompressibleNavierStokes.filter_convection!"><code>filter_convection!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/utils/filter_convection.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.filter_convection!" href="#IncompressibleNavierStokes.filter_convection!"><code>IncompressibleNavierStokes.filter_convection!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">filter_convection!(ū, u, diff_matrix, bc, α)</code></pre><p>Construct filter for convective terms.</p><p>Mutating/non-allocating/in-place version.</p><p>See also <a href="#IncompressibleNavierStokes.filter_convection"><code>filter_convection</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/utils/filter_convection.jl#L14-L22">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IncompressibleNavierStokes.get_lims" href="#IncompressibleNavierStokes.get_lims"><code>IncompressibleNavierStokes.get_lims</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_lims(x, n = 1.5)</code></pre><p>Get approximate lower and upper limits of a field <code>x</code> based on the mean and standard deviation (<span>$\mu \pm n \sigma$</span>). If <code>x</code> is constant, a margin of <code>1e-4</code> is enforced. This is required for contour plotting functions that require a certain range.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/d8b3a1dd1806da9b82fca998b69d19192f75d207/src/utils/get_lims.jl#L1-L7">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../theory/rom/">« Reduced Order Models</a><a class="docs-footer-nextpage" href="../tableaux/">Runge-Kutta methods »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Saturday 24 September 2022 10:56">Saturday 24 September 2022</span>. Using Julia version 1.8.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
