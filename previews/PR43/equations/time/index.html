<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Time discretization · IncompressibleNavierStokes.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://agdestein.github.io/IncompressibleNavierStokes.jl/equations/time/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="IncompressibleNavierStokes.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">IncompressibleNavierStokes.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../generated/LidDrivenCavity2D/">Tutorial: Lid-Driven Cavity (2D)</a></li><li><a class="tocitem" href="../../generated/Actuator2D/">Actuator (2D)</a></li><li><a class="tocitem" href="../../generated/BackwardFacingStep2D/">Backward Facing Step (2D)</a></li><li><a class="tocitem" href="../../generated/DecayingTurbulence2D/">Decaying Turbulunce (2D)</a></li><li><a class="tocitem" href="../../generated/PlanarMixing2D/">Planar Mixing (2D)</a></li><li><a class="tocitem" href="../../generated/ShearLayer2D/">Shear Layer (2D)</a></li></ul></li><li><span class="tocitem">Equations</span><ul><li><a class="tocitem" href="../ns/">Incompressible Navier-Stokes equations</a></li><li><a class="tocitem" href="../spatial/">Spatial discretization</a></li><li class="is-active"><a class="tocitem" href>Time discretization</a><ul class="internal"><li><a class="tocitem" href="#Explicit-Runge-Kutta-methods"><span>Explicit Runge-Kutta methods</span></a></li><li><a class="tocitem" href="#Implicit-Runge-Kutta-methods"><span>Implicit Runge-Kutta methods</span></a></li><li><a class="tocitem" href="#Adams-Bashforth-Crank-Nicolson-method"><span>Adams-Bashforth Crank-Nicolson method</span></a></li><li><a class="tocitem" href="#One-leg-beta-method"><span>One-leg beta method</span></a></li></ul></li></ul></li><li><span class="tocitem">Features</span><ul><li><a class="tocitem" href="../../features/precision/">Floating point precision</a></li><li><a class="tocitem" href="../../features/gpu/">GPU Support</a></li><li><a class="tocitem" href="../../features/les/">Large eddy simulation</a></li><li><a class="tocitem" href="../../features/pressure/">Pressure solvers</a></li><li><a class="tocitem" href="../../features/bc/">Boundary conditions</a></li><li><a class="tocitem" href="../../features/steppers/">Time steppers</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../../api/api/">API</a></li><li><a class="tocitem" href="../../api/tableaux/">Runge-Kutta methods</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Equations</a></li><li class="is-active"><a href>Time discretization</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Time discretization</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/agdestein/IncompressibleNavierStokes.jl/blob/main/docs/src/equations/time.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Time-discretization"><a class="docs-heading-anchor" href="#Time-discretization">Time discretization</a><a id="Time-discretization-1"></a><a class="docs-heading-anchor-permalink" href="#Time-discretization" title="Permalink"></a></h1><p>The spatially discretized Navier-Stokes equations form a differential-algebraic system, with an ODE for the velocity</p><p class="math-container">\[\Omega \frac{\mathrm{d} u_h}{\mathrm{d} t} = F(u_h) - (G p_h + y_G)\]</p><p>subject to the algebraic constraint formed by the mass equation</p><p class="math-container">\[M u_h + y_M = 0.\]</p><p>In the end of the <a href="../spatial/">previous section</a>, we differentiated the mass equation in time to obtain a discrete pressure Poisson equation. This equation includes the term <span>$\frac{\mathrm{d} y_M}{\mathrm{d} t}$</span>, which is non-zero if an unsteady flow of mass is added to the domain (Dirichlet boundary conditions). This term ensures that the time-continuous discrete velocity field <span>$u_h(t)$</span> stays divergence free (conserves mass). However, if we directly discretize this system in time, the mass preservation may actually not be respected. For this, we will change the definition of the pressure such that the time-discretized velocity field is divergence free at each time step and each time sub-step (to be defined in the following).</p><p>Consider the interval <span>$[0, T]$</span>. for some simulation time <span>$T$</span>. We will divide it into <span>$N$</span> sub-intervals <span>$[t^n, t^{n + 1}]$</span> for <span>$n = 0, \dots, N - 1$</span>, with <span>$t^0 = 0$</span>, <span>$t^N = T$</span>, and increment <span>$\Delta t^n = t^{n + 1} - t^n$</span>. We define <span>$U^n \approx u_h(t_n)$</span> as an approximation to the exact discrete velocity field <span>$u_h(t_n)$</span>, with <span>$U^0 = u_h(0)$</span> starting from the exact initial conditions.</p><h2 id="Explicit-Runge-Kutta-methods"><a class="docs-heading-anchor" href="#Explicit-Runge-Kutta-methods">Explicit Runge-Kutta methods</a><a id="Explicit-Runge-Kutta-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Explicit-Runge-Kutta-methods" title="Permalink"></a></h2><p>See Sanderse <a href="../../references/#Sanderse2012">[5]</a>.</p><p>For explicit Runge-Kutta methods, we divide each time step into <span>$s$</span> sub-steps. For <span>$i = 1, \dots, s$</span>, we define the following quantities:</p><p class="math-container">\[\begin{split}
U_0^n &amp; = U^n \\
\Delta t_i^n &amp; = c_i \Delta t^n \\
t_i^n &amp; = t^n + \Delta t_i^n \\
F_i &amp; = F(U_{i - 1}^n, t_{i - 1}^n) \\
V_i^n &amp; = U^n + \Delta t^n \sum_{j = 1}^i a_{i j} F_j \\
L P_i^n &amp; = \frac{(M V_i^n + y_M(t_i^n)) - (M U^n + y_M(t^n))}{\Delta t_i^n} \\
&amp; = \frac{1}{c_i} \sum_{j = 1}^i a_{i j} F_j +
\frac{y_M(t_i^n) - y_M(t^n)}{\Delta t_i^n} \\
U_i^n &amp; = V_i^n - \Delta t_i^n G P_i^n,
\end{split}\]</p><p>where <span>$(a_ij)_{i j}$</span> are the Butcher tableau coefficients of the RK-method, with the convention <span>$c_i = \sum_{j = 1}^i a_{i j}$</span> and <span>$c_0 = 0$</span>.</p><p>Finally, we set <span>$U^{n + 1} = U_s^n$</span>. The corresponding pressure <span>$P^{n + 1}$</span> can be calculated to the same accuracy as <span>$U^{n + 1}$</span> by doing an additional pressure projection (if we know <span>$\frac{\mathrm{d} y_M}{\mathrm{d} t}(t^{n + 1})$</span>), or to first order accuracy by simply taking <span>$P^{n + 1} = P_s^n$</span>.</p><p>Note that each of the sub-step velocities <span>$U_i^n$</span> is divergence free, after projecting the tentative velocities <span>$V_i^s$</span>. This is ensured due to the judiciously chosen replacement of <span>$\frac{\mathrm{d} y_M}{\mathrm{d} t}(t_i^n)$</span> with <span>$(y_M(t_i^n) - y_M(t^n)) / \Delta t_i^n$</span>.</p><h2 id="Implicit-Runge-Kutta-methods"><a class="docs-heading-anchor" href="#Implicit-Runge-Kutta-methods">Implicit Runge-Kutta methods</a><a id="Implicit-Runge-Kutta-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Implicit-Runge-Kutta-methods" title="Permalink"></a></h2><p>See Sanderse <a href="../../references/#Sanderse2013">[6]</a>.</p><h2 id="Adams-Bashforth-Crank-Nicolson-method"><a class="docs-heading-anchor" href="#Adams-Bashforth-Crank-Nicolson-method">Adams-Bashforth Crank-Nicolson method</a><a id="Adams-Bashforth-Crank-Nicolson-method-1"></a><a class="docs-heading-anchor-permalink" href="#Adams-Bashforth-Crank-Nicolson-method" title="Permalink"></a></h2><h2 id="One-leg-beta-method"><a class="docs-heading-anchor" href="#One-leg-beta-method">One-leg beta method</a><a id="One-leg-beta-method-1"></a><a class="docs-heading-anchor-permalink" href="#One-leg-beta-method" title="Permalink"></a></h2></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../spatial/">« Spatial discretization</a><a class="docs-footer-nextpage" href="../../features/precision/">Floating point precision »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Sunday 10 September 2023 15:27">Sunday 10 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
